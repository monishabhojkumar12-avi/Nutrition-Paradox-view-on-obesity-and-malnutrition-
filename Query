conn = sqlite3.connect("health_data.db")
pd.read_sql("SELECT COUNT(*) FROM obesity", conn)

pd.read_sql("SELECT * FROM obesity LIMIT 5", conn)
------------------
query = """
SELECT
    Region,
    AVG(Mean_Estimate) AS avg_obesity
FROM obesity
WHERE Year = 2022
GROUP BY Region
ORDER BY avg_obesity DESC
LIMIT 5;
"""
---------------
query = """
SELECT
    Country,
    MAX(Mean_Estimate) AS mean_estimate
FROM obesity
WHERE Year = 2022
GROUP BY Country
ORDER BY mean_estimate DESC
LIMIT 5;
"""
top_5_country = pd.read_sql(query, conn)
----------------
query = """
SELECT 
    Gender,
    AVG(Mean_Estimate) AS avg_obesity
FROM obesity_data
GROUP BY Gender
ORDER BY avg_obesity DESC;
"""
----------------
query_top5_countries = """
SELECT 
    Country,
    AVG(Mean_Estimate) AS avg_malnutrition
FROM malnutrition_data
GROUP BY Country
ORDER BY avg_malnutrition DESC
LIMIT 5;
"""
-----------------
query_africa_trend = """
SELECT 
    Year,
    AVG(Mean_Estimate) AS avg_malnutrition
FROM malnutrition_data
WHERE Region = 'Africa'
GROUP BY Year
ORDER BY Year;
"""
----------------
query_age_obesity = """
SELECT 
    Year,
    Age_Group,
    AVG(Mean_Estimate) AS avg_obesity
FROM obesity_data
GROUP BY Year, Age_Group
ORDER BY Year, Age_Group;
"""
---------------
query_ob_vs_mal = """
SELECT 
    o.Country,
    AVG(o.Mean_Estimate) AS avg_obesity,
    AVG(m.Mean_Estimate) AS avg_malnutrition
FROM obesity_data o
JOIN malnutrition_data m 
    ON o.Country = m.Country
GROUP BY o.Country
ORDER BY o.Country
LIMIT 5;
"""
print(top_5_country)
